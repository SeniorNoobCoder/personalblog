<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ecare.web.server.info">
    <!-- 查询分页 -->
    <select id="findListPage" resultType="pd" parameterType="page">
        SELECT * FROM server_info
        WHERE 1=1
        <if test="pd.status != null and pd.status != '' ">
            AND status = #{pd.status}
        </if>
        <if test="pd.server_category_id != null and pd.server_category_id != '' ">
            AND server_category_id = #{pd.server_category_id}
        </if>
        <if test="pd.partner_id != null and pd.partner_id != '' ">
            AND partner_id = #{pd.partner_id}
        </if>
        <if test="pd.remove_logo != null and pd.remove_logo != '' ">
            AND remove_logo = #{pd.remove_logo}
        </if>
        AND status != '0'
        ORDER BY create_time DESC
    </select>
    <!--  查询无分页 -->
    <select id="findList" parameterType="pd" resultType="pd">
        SELECT  * FROM server_info
        WHERE 1=1
        <if test="status != null and status != '' ">
            AND status = #{status}
        </if>
        <if test="server_category_id != null and server_category_id != '' ">
            AND server_category_id = #{server_category_id}
        </if>
        <if test="partner_id != null and partner_id != '' ">
            AND partner_id = #{partner_id}
        </if>
        ORDER BY create_time
    </select>
    <!--查询信息详情-->
    <select id="findInfo" resultType="pd" parameterType="pd">
        SELECT *  FROM server_info
        WHERE id =#{id}
    </select>


    <!--保存信息-->
    <insert id="save" parameterType="pd">
        insert into server_info (
        title,
        content,
        server_category_id,
        server_category_name,
        partner_id,
        partner_name,
        create_time,
        remove_logo,
        status)
        values (
        #{title},
        #{content},
        #{server_category_id},
        #{server_category_name},
        #{partner_id},
        #{partner_name},
        NOW(),
        #{remove_logo},
        #{status})
    </insert>
    <!--更新信息-->
    <update id="update" parameterType="pd">
        update server_info set
        <if test="server_category_id != null and server_category_id != '' ">
            server_category_id=#{server_category_id},
        </if>
        <if test="content != null and content != '' ">
            content=#{content},
        </if>
        <if test="status != null and status != '' ">
            status=#{status},
        </if>
        update_time= NOW()
        where id=#{id}
    </update>

    <!--审核信息-->
    <update id="updateStatus" parameterType="pd">
        UPDATE server_info set
        <if test="status != null and status != '' ">
            status=#{status},
        </if>
        <if test="operator_id != null and operator_id != '' ">
            operator_id=#{operator_id},
        </if>
        <if test="operator_name != null and operator_name != '' ">
            operator_name=#{operator_name},
        </if>
        operator_time= NOW()
        where id=#{id} AND  (status = '1' OR status = '2')
    </update>
    <!--删除信息-->
    <delete id="delete" parameterType="String">
        delete from server_info where id=#{id}
    </delete>
    <!--查询条数-->
    <select id="findListNum" parameterType="pd" resultType="Integer">
        select count(*) from server_info
        where 1=1
        <if test="status != null and status != '' ">
            AND status = #{status}
        </if>
        <if test="server_category_id != null and server_category_id != '' ">
            AND server_category_id = #{server_category_id}
        </if>
        <if test="partner_id != null and partner_id != '' ">
            AND partner_id = #{partner_id}
        </if>
        ORDER BY create_time
    </select>
</mapper>