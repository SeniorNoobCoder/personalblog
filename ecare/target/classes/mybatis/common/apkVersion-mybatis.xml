<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

	<mapper namespace="com.ecare.web.common.apkVersion">

	<!-- 查询列表信息 -->
	<select id="findListPage" parameterType="Page" resultType="pd">
		select 
			a.id as "id",
    		a.device_type as "device_type",
    		a.type as "type",
    		a.title as "title",
    		a.content as "content",
    		a.version_code as "version_code",
    		a.status as "status",
    		a.file_address as "file_address",
    		a.remark as "remark",
    		a.remove_logo as "remove_logo",
    		a.create_user as "create_user",
    		a.create_time as "create_time",
    		a.update_time as "update_time"
    	from common_apkversion a
    		where 1=1
    		<if test="pd.remove_logo != null and pd.remove_logo != ''">
			and a.remove_logo=#{pd.remove_logo}
			</if>
    		<if test="pd.title != null and pd.title != ''"><!-- 标题检索 -->
			and a.title like concat('%', #{pd.title},'%')
			</if>
			<if test="pd.device_type != null and pd.device_type != ''">
			and a.device_type=#{pd.device_type}
			</if>
    		order by a.create_time desc
	</select>
	
	<!--查询版本信息详情-->
    <select id="findInfo" parameterType="pd" resultType="pd">
    	select 
			a.id as "id",
    		a.device_type as "device_type",
    		a.type as "type",
    		a.title as "title",
    		a.content as "content",
    		a.version_code as "version_code",
    		a.status as "status",
    		a.file_address as "file_address",
    		a.remark as "remark",
    		a.remove_logo as "remove_logo",
    		a.create_user as "create_user",
    		a.create_time as "create_time",
    		a.update_time as "update_time"
    	from common_apkversion a
    	where a.id=#{id}
    </select>
    
    <!-- 添加版本信息 -->
	<insert id="save" parameterType="pd">
		insert into common_apkversion (
    			device_type,
    			type,
    			title,
    			content,
    			version_code,
    			status,
    			file_address,
    			remark,
    			remove_logo,
    			create_user,
    			create_time,
    			update_time
    			)
    			values
    			(
				#{device_type},
				#{type},
				#{title},
				#{content},
				#{version_code},
				#{status},
				#{file_address},
				#{remark},
				#{remove_logo},
				#{create_user},
				#{create_time},
				#{update_time}
				)
    </insert>
    
    <!--更新信息-->
    <update id="update" parameterType="pd">
    	update common_apkversion set 
    		<if test="device_type != null and device_type != '' ">
				device_type=#{device_type},
			</if>
			<if test="type != null and type != '' ">
				type=#{type},
			</if>
			<if test="title != null and title != '' ">
				title=#{title},
			</if>
			<if test="content != null and content != '' ">
				content=#{content},
			</if>
			<if test="version_code != null and version_code != '' ">
				version_code=#{version_code},
			</if>
			<if test="status != null and status != '' ">
				status=#{status},
			</if>
			<if test="file_address != null and file_address != '' ">
				file_address=#{file_address},
			</if>
			<if test="remark != null and remark != '' ">
				remark=#{remark},
			</if>
			<if test="remove_logo != null and remove_logo != '' ">
				remove_logo=#{remove_logo},
			</if>
    		update_time=#{update_time}
    		where id=#{id}
    		
    </update>
    
    <!--删除信息-->
    <delete id="delete" parameterType="String">
    	delete from common_apkversion where id=#{id}
    </delete>
    
    <!--查询已删除信息数量-->
    <select id="findDelNum" parameterType="pd" resultType="Integer">
    	select count(*) from common_apkversion where remove_logo='Y' 
    </select>
    
    <!--查询已删除用户ids-->
    <select id="findListIds" parameterType="pd" resultType="Integer">
    	select 
    		a.id as "id"
    	 from common_apkversion a
    	 where a.remove_logo='Y'
    </select>
	</mapper>